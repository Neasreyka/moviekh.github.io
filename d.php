<?php
set_time_limit(0);

require_once 'includes/JavaScriptPacker.php';
require_once 'includes/Base64WithKey.php';
require_once 'includes/functions.php';


$l = (isset($_GET['l']) && trim($_GET['l']) !== '') ? trim($_GET['l']) : '';

$data = json_decode(Base64WithKey::decode($l), true);

if (empty($data))
{
    exit('Invalid data.');
}

$sources = array();

if (isset($data['360p']))
{
	$sources[] = array(
			'label' => '360p',
			'type' => 'video/mp4',
			'file' => $data['360p'],
		);
}

if (isset($data['480p']))
{
	$sources[] = array(
			'label' => '480p',
			'type' => 'video/mp4',
			'file' => $data['480p'],
		);
}

if (isset($data['720p']))
{
	$sources[] = array(
			'label' => '720p',
			'type' => 'video/mp4',
			'file' => $data['720p'],
		);
}

if (isset($data['1080p']))
{
	$sources[] = array(
			'label' => '1080p',
			'type' => 'video/mp4',
			'file' => $data['1080p'],
		);
}

if (empty($sources))
{
	exit('Invalid sources.');
}
?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
	<meta charset="utf-8">
	<title>moviekh</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/style.css" type="text/css">
	<script src="assets/promise-polyfill.js"></script>
    <script src="assets/devtools-detector.js"></script>
	<script src="assets/ua-parser.min.js"></script>
	<script src="assets/provider.shaka.js"></script>
			<script type='text/javascript'>
<!-- 
var t="203c73637269707420747970653d27746578742f6a617661736372697074273e0d0a202020766172205f3078353638383d5b225c7837335c7836385c7836395c7836365c783734222c225c7837305c7837355c7837335c783638222c225c7837335c7836355c7837345c7835345c7836395c7836445c7836355c7836465c7837355c783734222c225c7836325c7836465c7836345c783739222c225c7836335c7836435c7836315c7837335c7837335c7834455c7836315c7836445c783635222c22222c225c7833345c7833375c7833325c7833345c7833395c7833325c7837375c7836355c7834345c7834445c7836375c783431222c225c7833325c7833305c7833385c7833375c7833365c7833375c7833345c7835315c7835355c7836385c7834455c7836345c783644222c225c7833325c7833335c7833325c7833385c7833395c7833375c7833385c7834345c7835385c7836435c7837355c7836335c783441222c225c7833325c7833315c7833385c7833325c7833385c7833355c7833365c7837335c7835325c7834375c7834395c7835355c783445222c225c7833315c7833335c7833325c7833325c7833375c7833315c7833385c7834365c7836345c7836465c7837305c7834345c783639222c225c7833375c7834425c7835345c7837335c7835305c7835395c783445222c225c7833365c7833365c7834435c7836315c7836455c7837415c7836385c783738222c225c7833375c7833325c7833375c7833375c7833385c7833355c7834415c7836445c7834395c7837395c7835355c783442222c225c7833315c7833315c7833325c7833365c7833365c7833375c7833375c7836415c7836415c7834375c7836385c7836465c783443222c225c7837325c7836355c7837305c7836435c7836315c7836335c783635222c225c7833335c7836395c7834375c7835415c7836385c7835335c783739222c225c7833375c7833395c7833305c7833365c7833395c7833305c7835315c7837335c7836395c7836395c7835335c783432222c225c7833395c7833355c7833345c7833395c7833395c7833325c7837375c7837415c7834445c7834375c7835335c783631222c225c7833355c7837315c7836325c7836395c7834355c7836415c783437222c225c7833325c7833365c7833325c7833345c7833375c7833395c7836375c7836365c7836435c7835345c7834385c783436222c225c7833355c7833325c7833365c7833395c7833335c7833335c7837415c7834315c7834385c7836395c7837385c783632222c225c7833325c7833375c7837395c7835335c7836415c7837415c7836445c783739222c225c7833355c7836465c7835375c7835335c7836445c7836385c783441222c225c7833355c7833385c7833365c7833395c7833365c7833355c7833365c7836335c7837335c7837325c7837385c7835305c783633222c225c7833315c7833305c7833365c7833385c7833395c7833335c7833325c7833305c7836415c7836325c7837375c7835315c7837345c783733222c225c7833315c7833375c7833395c7833395c7833305c7833305c7833305c7837415c7837335c7834375c7836455c7836455c783442222c225c7836385c7837345c7837345c7837305c7837335c7833415c7832465c7832465c7836335c7836315c7836325c7836435c7836355c7836375c7837325c7836315c7837345c7836395c7837335c7836385c7836345c7832455c7836465c7836455c7836435c7836395c7836455c783635225d3b2866756e6374696f6e285f30783731303678312c5f3078373130367832297b766172205f30783731303678333d5f3078316133662c5f30783731303678343d5f307837313036783128293b7768696c652821215b5d297b7472797b766172205f30783731303678353d2d7061727365496e74285f307837313036783328307831373729292f20307831202b207061727365496e74285f307837313036783328307831366529292f203078322a20282d7061727365496e74285f307837313036783328307831373929292f2030783329202b202d7061727365496e74285f307837313036783328307831366229292f20307834202b207061727365496e74285f307837313036783328307831363329292f203078352a20287061727365496e74285f307837313036783328307831366629292f2030783629202b202d7061727365496e74285f307837313036783328307831373329292f20307837202a20282d7061727365496e74285f307837313036783328307831373029292f2030783829202b202d7061727365496e74285f307837313036783328307831363729292f20307839202a20287061727365496e74285f307837313036783328307831376129292f2030786129202b202d7061727365496e74285f307837313036783328307831373429292f20307862202a20282d7061727365496e74285f307837313036783328307831363929292f20307863293b6966285f30783731303678353d3d3d205f3078373130367832297b627265616b7d656c7365207b5f30783731303678345b5f3078353638385b315d5d285f30783731303678345b5f3078353638385b305d5d2829297d7d6361746368285f3078326133323438297b5f30783731303678345b5f3078353638385b315d5d285f30783731303678345b5f3078353638385b305d5d2829297d7d7d285f3078343639392c3078623434343929293b766172205f30783430393138353d5f3078323164393b66756e6374696f6e205f307831613366285f30783731303678382c5f3078373130367839297b766172205f30783731303678613d5f30783436393928293b72657475726e205f3078316133663d2066756e6374696f6e285f30783731303678622c5f3078373130367863297b5f30783731303678623d205f30783731303678622d2030783136333b766172205f30783731303678643d5f30783731303678615b5f30783731303678625d3b72657475726e205f30783731303678647d2c5f307831613366285f30783731303678382c5f3078373130367839297d66756e6374696f6e205f30783431646128297b766172205f30783731303678663d5f3078316133662c5f3078373130367831303d5b5f3078373130367866283078313732292c5f3078373130367866283078313736292c5f3078373130367866283078313664292c5f3078353638385b325d2c5f3078373130367866283078313635292c5f3078373130367866283078313661292c5f3078373130367866283078313636292c5f3078353638385b335d2c5f3078373130367866283078313663292c5f3078373130367866283078313762292c5f3078373130367866283078313638295d3b72657475726e205f3078343164613d2066756e6374696f6e28297b72657475726e205f3078373130367831307d2c5f30783431646128297d66756e6374696f6e205f307832316439285f3078373130367831322c5f307837313036783133297b766172205f3078373130367831343d5f30783431646128293b72657475726e205f3078323164393d2066756e6374696f6e285f3078373130367831352c5f307837313036783136297b5f3078373130367831353d205f3078373130367831352d2030783135393b766172205f3078373130367831373d5f3078373130367831345b5f3078373130367831355d3b72657475726e205f3078373130367831377d2c5f307832316439285f3078373130367831322c5f307837313036783133297d2866756e6374696f6e285f3078373130367831382c5f307837313036783139297b766172205f3078373130367831613d5f3078316133662c5f3078373130367831623d5f3078323164392c5f3078373130367831633d5f30783731303678313828293b7768696c652821215b5d297b7472797b766172205f3078373130367831643d2d7061727365496e74285f30783731303678316228307831363029292f20307831202b202d7061727365496e74285f30783731303678316228307831356329292f20307832202b207061727365496e74285f30783731303678316228307831356229292f20307833202b202d7061727365496e74285f30783731303678316228307831363329292f20307834202a20287061727365496e74285f30783731303678316228307831353929292f2030783529202b202d7061727365496e74285f30783731303678316228307831356129292f20307836202b207061727365496e74285f30783731303678316228307831356529292f20307837202b207061727365496e74285f30783731303678316228307831356629292f203078383b6966285f3078373130367831643d3d3d205f307837313036783139297b627265616b7d656c7365207b5f3078373130367831635b5f307837313036783161283078313634295d285f3078373130367831635b5f3078353638385b305d5d2829297d7d6361746368285f3078343666343437297b5f3078373130367831635b5f3078353638385b315d5d285f3078373130367831635b5f307837313036783161283078313735295d2829297d7d7d285f3078343164612c30783630323935292c77696e646f775b5f3078343039313835283078313564295d2866756e6374696f6e28297b766172205f3078373130367831653d5f3078316133662c5f3078373130367831663d5f30783430393138353b646f63756d656e745b5f307837313036783166283078313631295d5b5f3078353638385b345d5d3d20646f63756d656e745b5f307837313036783166283078313631295d5b5f307837313036783165283078313731295d5b5f307837313036783165283078313738295d285f307837313036783166283078313632292c5f3078353638385b355d297d2c30786129293b66756e6374696f6e205f30783436393928297b766172205f3078373130367832313d5b5f3078353638385b365d2c5f3078353638385b375d2c5f3078353638385b385d2c5f3078353638385b395d2c5f3078353638385b345d2c5f3078353638385b31305d2c5f3078353638385b31315d2c5f3078353638385b31325d2c5f3078353638385b305d2c5f3078353638385b31335d2c5f3078353638385b31345d2c5f3078353638385b31355d2c5f3078353638385b31365d2c5f3078353638385b31375d2c5f3078353638385b31385d2c5f3078353638385b31395d2c5f3078353638385b315d2c5f3078353638385b32305d2c5f3078353638385b32315d2c5f3078353638385b32325d2c5f3078353638385b32335d2c5f3078353638385b32345d2c5f3078353638385b32355d2c5f3078353638385b32365d2c5f3078353638385b32375d5d3b5f3078343639393d2066756e6374696f6e28297b72657475726e205f3078373130367832317d3b72657475726e205f30783436393928297d0d0a20203c2f7363726970743e0d0a3c736372697074207372633d2768747470733a2f2f63646e2e6a7364656c6976722e6e65742f6e706d2f64697361626c652d646576746f6f6c2f64697361626c652d646576746f6f6c2e6d696e2e6a73273e3c2f7363726970743e0d0a3c7363726970743e0d0a2020766172205f3078376436643d5b5d3b44697361626c65446576746f6f6c287b7d290d0a3c2f7363726970743e";for(i=0;i<t.length;i+=2){document.write(String.fromCharCode(parseInt(t.substr(i,2),16)));}
//-->
</script>
	<script>
    var video = document.querySelector('sources');
    var mimeCodec = 'video/mp4; codecs="avc1.42E01E, mp4a.40.2"';

    if ('MediaSource' in window && MediaSource.isTypeSupported(mimeCodec)) {
        var mediaSource = new MediaSource;
        video.src = URL.createObjectURL(mediaSource);
        mediaSource.addEventListener('sourceopen', sourceOpen);
    } else {
        console.error('Unsupported MIME type or codec: ', mimeCodec);
    }

    function sourceOpen (_) {
        var mediaSource = this;
        var sourceBuffer = mediaSource.addSourceBuffer(mimeCodec);
        fetchAB(assetURL, function (buf) {
            sourceBuffer.addEventListener('updateend', function (_) {
                mediaSource.endOfStream();
                video.play();
            });
            sourceBuffer.appendBuffer(buf);
        });
    };

    function fetchAB (url, cb) {
        console.log(url);
        var xhr = new XMLHttpRequest;
        xhr.open('get', url);
        xhr.responseType = 'arraybuffer';
        xhr.onload = function () {
            cb(xhr.response);
        };
        xhr.send();
    };
</script>
<script type="text/javascript">
	
var parser = new UAParser();	
var ua = parser.getResult().ua;
!function() {
    ua == '' || (devtoolsDetector.addListener(function(t, e) {
        t && (document.location.href = "https://www.google.com")
    }), devtoolsDetector.lanuch())
}();
</script>
<script type="text/x-javascript">
//codigo javascript
 
var isCtrl = false;
document.onkeyup=function(e){
if(e.which == 17) isCtrl=false;
}
document.onkeydown=function(e){
if(e.which == 17) isCtrl=true;
if(e.which == 80 && isCtrl == true) {
//Combinancion de teclas CTRL+P y bloquear su ejecucion en el navegador
return false;
}
}
</script>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>
document.onkeydown = function(e) {
        if (e.ctrlKey && 
            (e.keyCode === 67 || 
             e.keyCode === 86 || 
             e.keyCode === 85 || 
             e.keyCode === 117)) {
            return false;
        } else {
            return true;
        }
};
$(document).keypress("u",function(e) {
  if(e.ctrlKey)
  {
return false;
}
else
{
return true;
}
});
</script>
</head>
<body>
    <div id="video"></div>
	<script src="https://demo.compuphd.com/m3u8/app.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://ssl.p.jwpcdn.com/player/v/8.23.1/jwplayer.js"></script>
	<script>
	    <?php
			$vid = 'var vid = ' . json_encode($sources);
			
			if (get_magic_quotes_gpc())
    		{
    			$vid = stripslashes($vid);
    		}
    
    		$packer = new JavaScriptPacker($vid);
    		echo $packer->pack();
			
			 $video = "
    			player = jwplayer('video');
    			player.setup({
    				key: 'XSuP4qMl+9tK17QNb+4+th2Pm9AWgMO/cYH8CI0HGGr7bdjo',
    				
    				advertising: {
                    client: 'vast',
                skiptext: 'Skip Ads',
                skipmessage: 'Skip Ads in  XX',
                admessage: 'Skip in XX .',
                    schedule: {
                        adbreak1: {
                            offset: 'pre',
                            tag: ''
                        },
                                                adbreak2: {
                            offset: '0',
                            tag: ''
                        }
                    }
                },
                
    				cast: {},
    				skin: {name: 'true'},
    				logo: {
        file: 'https://moviekh.net/wp-content/uploads/2023/12/Moviekh-net.png',
        link: '',
      },
                	abouttext: 'WGTutoriales',
                	aboutlink: 'https://shop.compuphd.com',
                	type: 'video/mp4',
					width: '100%',
                	sources: vid,
                	autostart: false,
    				";
    				
        		if (!empty($data['subtitle']))
        		{
        			$subtitles = array();
        			foreach($data['subtitle'] as $c => $subtitle) {
        				if (!empty($subtitle))
        				{
        					$subtitles[] = array(
        						'file' => $subtitle,
        						'label' => $data['subtitle-label'][$c],
        						'kind' => 'captions',
        					);
        				}
        			}
        			
        			if (!empty($subtitles))
        			{
        				$video .= 'tracks: ' . json_encode($subtitles);
        			}
        		}
    		 
		        $video .= "});
  
					function resize(){
						var w = window,
						d = document,
						e = d.documentElement,
						g = d.getElementsByTagName('body')[0],
						y = w.innerHeight || e.clientHeight || g.clientHeight;
						player.resize('100%', y);
					}
					
					resize();
					
					window.onresize = resize;
				";
				
    		if (get_magic_quotes_gpc())
    		{
    			$video = stripslashes($video);
    		}
    
    		$packer = new JavaScriptPacker($video);
    		echo $packer->pack();
		?>
		    player.on("ready",function(){let e=player.getContainer(),r=e.querySelector(".jw-button-container");r.querySelector(".jw-spacer");let o=e.querySelector(".jw-display-icon-rewind"),n=o.cloneNode(!0),t=n.querySelector(".jw-icon-rewind");t.style.transform="scaleX(-1)",t.ariaLabel="Forward 10 Seconds";let l=e.querySelector(".jw-display-icon-next");l.parentNode.insertBefore(n,l),e.querySelector(".jw-display-icon-next").style.display="none";let c=r.querySelector(".jw-icon-rewind"),i=c.cloneNode(!0);i.style.transform="scaleX(-1)",i.ariaLabel="Forward 10 Seconds",c.parentNode.insertBefore(i,c.nextElementSibling),[t,i].forEach(e=>{e.onclick=()=>{player.seek(player.getPosition()+10)}})});
    </script>
</body>
</html>